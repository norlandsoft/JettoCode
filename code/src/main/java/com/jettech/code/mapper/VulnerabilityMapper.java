package com.jettech.code.mapper;

import com.jettech.code.entity.Vulnerability;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;

import java.util.List;

@Mapper
public interface VulnerabilityMapper {
    List<Vulnerability> findByDependencyId(Long dependencyId);
    
    Vulnerability findById(Long id);
    
    List<Vulnerability> findBySeverity(@Param("dependencyId") Long dependencyId, @Param("severity") String severity);
    
    int countByDependencyId(Long dependencyId);
    
    int insert(Vulnerability vulnerability);
    
    int batchInsert(List<Vulnerability> vulnerabilities);
    
    int update(Vulnerability vulnerability);
    
    int deleteByDependencyId(Long dependencyId);
    
    int deleteById(Long id);
}
